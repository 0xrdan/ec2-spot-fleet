# Example: Long-running computation job
# Copy this to the root as fleet.env and customize

# =============================================================================
# AWS SETTINGS
# =============================================================================

FLEET_REGION="us-east-1"
FLEET_KEY_NAME="my-keypair"
FLEET_SECURITY_GROUP="sg-xxxxxxxxx"
FLEET_AMI_ID="ami-0f670b5aa9dce5d62"  # Ubuntu 22.04 Deep Learning AMI

# =============================================================================
# INSTANCE SETTINGS
# =============================================================================

FLEET_PROJECT_TAG="long-running-job"
FLEET_PROFILE="compute"
FLEET_MAX_INSTANCES=6

# =============================================================================
# WORKSPACE
# =============================================================================

FLEET_WORKSPACE="/home/ubuntu/work"
FLEET_SYNC_PATH="/path/to/your/project"
FLEET_SYNC_EXCLUDE="target .git node_modules venv __pycache__"

# =============================================================================
# MONITORING
# =============================================================================

FLEET_WATCH_INTERVAL=300    # Check every 5 minutes
FLEET_RECOVERY_TIMEOUT=600  # Allow 10 minutes for recovery

# =============================================================================
# ALERTING
# =============================================================================

FLEET_ALERT_EMAIL="your-email@example.com"
FLEET_SMTP_HOST="smtp.gmail.com"
FLEET_SMTP_PORT=587
FLEET_SMTP_USER="your-email@gmail.com"
FLEET_SMTP_CREDENTIALS="/home/ubuntu/.smtp-credentials"

# =============================================================================
# JOB CONFIGURATION
# =============================================================================

JOB_NAME="my-computation"

# Build command (optional - for compiled languages)
JOB_BUILD_CMD="make build"

# Start command with placeholders
# %NUM% = instance number, %START%/%END% = range from instances.json
# %CHECKPOINT% = checkpoint file path, %WORKSPACE% = workspace path
JOB_START_CMD="python3 %WORKSPACE%/main.py --range-start %START% --range-end %END% --checkpoint %CHECKPOINT% --instance %NUM%"

# Pattern to detect running process
JOB_PROCESS_PATTERN="main.py"

# Log file pattern
JOB_LOG_PATTERN="/home/ubuntu/computation_%NUM%.log"

# =============================================================================
# CHECKPOINTING (S3)
# =============================================================================

JOB_S3_BUCKET="my-job-checkpoints"
JOB_CHECKPOINT_PREFIX="checkpoint_"

# Patterns for detecting success
JOB_RESULT_PATTERN="results"
JOB_SUCCESS_PATTERN="COMPLETE|FOUND|SUCCESS"
